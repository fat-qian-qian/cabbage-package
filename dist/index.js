"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("prop-types"),n=require("@chakra-ui/react"),l=require("@chakra-ui/icons"),a=require("@tanstack/react-table"),r=require("react-icons/md");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=o(e),i=o(t);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},c.apply(this,arguments)}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var l,a,r,o,u=[],i=!0,c=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(l=r.call(n)).done)&&(u.push(l.value),u.length!==t);i=!0);}catch(e){c=!0,a=e}finally{try{if(!i&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return u}}(e,t)||g(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=new Array(t);n<t;n++)l[n]=e[n];return l}var m=function(e){var t=e.table;return u.default.createElement(n.Flex,{alignItems:"center"},u.default.createElement(n.Text,{mr:4},"每頁顯示"),u.default.createElement(n.Select,{w:"auto",value:t.getState().pagination.pageSize,onChange:function(e){return t.setPageSize(Number(e.target.value))}},[10,20,30,40,50].map((function(e){return u.default.createElement("option",{key:e,value:e},e)}))))},b=function(e){var t=e.table;return console.log(t.getCanNextPage()),console.log(t.getCanPreviousPage()),u.default.createElement(n.Flex,{gap:0,w:"60%",placeContent:"center"},u.default.createElement(n.Button,{rounded:"full",roundedRight:"none",colorScheme:t.getCanPreviousPage()?"teal":"gray",onClick:function(){return t.setPageIndex(0)},isDisabled:!t.getCanPreviousPage()},u.default.createElement(n.Icon,{as:r.MdSkipPrevious})),u.default.createElement(n.Button,{rounded:"none",colorScheme:t.getCanPreviousPage()?"teal":"gray",onClick:function(){t.getCanPreviousPage()&&t.previousPage()},isDisabled:!t.getCanPreviousPage()},u.default.createElement(n.Icon,{as:r.MdNavigateBefore})),u.default.createElement(n.NumberInput,{w:"5vw",value:t.getState().pagination.pageIndex+1,min:1,max:t.getPageCount(),onChange:function(e){return t.setPageIndex(Number(e)-1)}},u.default.createElement(n.NumberInputField,{w:"100%",borderRadius:"none",textAlign:"center",padding:0,margin:0})),u.default.createElement(n.Input,{w:"5vw",borderRadius:"none",textAlign:"center",value:" / ".concat(t.getPageCount()," 頁"),isReadOnly:!0,bg:"gray.100"}),u.default.createElement(n.Button,{rounded:"none",colorScheme:t.getCanNextPage()?"teal":"gray",onClick:function(){t.getCanNextPage()&&t.nextPage()},isDisabled:!t.getCanNextPage()},u.default.createElement(n.Icon,{as:r.MdNavigateNext})),u.default.createElement(n.Button,{rounded:"full",roundedLeft:"none",colorScheme:t.getCanNextPage()?"teal":"gray",onClick:function(){return t.setPageIndex(t.getPageCount()-1)},isDisabled:!t.getCanNextPage()},u.default.createElement(n.Icon,{as:r.MdSkipNext})))},p=function(e){var t=e.columns,r=e.data,o=e.tableStyle,i=e.thStyle,g=e.tdStyle,s=e.enableMultiSelect,m=e.onSelectedRowsChange,b=e.enablePagination,p=e.enableCaption,h=e.enableFilter,w=e.enableRowDoubleClick,E=e.rowDoubleClickHandler,S=e.caption,x=d(u.default.useState([]),2),k=x[0],P=x[1],R=a.useReactTable({columns:t,data:r,state:{sorting:k},onSortingChange:P,getCoreRowModel:a.getCoreRowModel(),getFilteredRowModel:a.getFilteredRowModel(),getPaginationRowModel:a.getPaginationRowModel(),getSortedRowModel:a.getSortedRowModel(),debugTable:!0}),I=b?R.getPaginationRowModel().rows:R.getCoreRowModel().rows,A=u.default.useCallback((function(e){w&&E(e)}),[w,E]),j=d(u.default.useState([]),2),D=j[0],F=j[1],M=d(u.default.useState(!1),2),T=M[0],O=M[1],N=u.default.useCallback((function(e){F((function(t){var n;return n=t.includes(e)?t.filter((function(t){return t!==e})):[].concat(f(t),[e]),m&&m(n),n}))}),[m]),B=u.default.useCallback((function(){if(T)F([]),m&&m([]);else{var e=I.map((function(e){return e.id}));F(e),m&&m(e)}O((function(e){return!e}))}),[T,I,m]);return u.default.createElement(n.TableContainer,null,u.default.createElement(n.Table,o,p&&u.default.createElement(y,{caption:S}),u.default.createElement(n.Thead,null,R.getHeaderGroups().map((function(e){return u.default.createElement(n.Tr,{key:e.id},s&&u.default.createElement(n.Th,c({},i,{cursor:"pointer",onClick:B}),u.default.createElement(n.Flex,{alignItems:"center",justifyContent:"center",position:"relative"},u.default.createElement("input",{type:"checkbox",checked:T,readOnly:!0}))),e.headers.map((function(e){return u.default.createElement(n.Th,c({},i,{key:e.id,cursor:"pointer"}),u.default.createElement(n.Flex,{alignItems:"center",justifyContent:"center",position:"relative"},a.flexRender(e.column.columnDef.header,e.getContext()),!e.column.columnDef.render&&h&&u.default.createElement(n.IconButton,{"aria-label":"Sort",icon:{desc:u.default.createElement(l.ArrowDownIcon,null),asc:u.default.createElement(l.ArrowUpIcon,null),false:u.default.createElement(l.ArrowUpIcon,{opacity:.5})}[e.column.getIsSorted()],onClick:e.column.getToggleSortingHandler(),size:"xs",colorScheme:"black",position:"absolute",right:"0"})),h&&e.column.getCanFilter()&&!e.column.columnDef.render?u.default.createElement("div",null,u.default.createElement(v,{column:e.column,table:R})):null)})))}))),u.default.createElement(n.Tbody,null,I.map((function(e){return u.default.createElement(n.Tr,{key:e.id,_hover:{bg:"gray.100"},onDoubleClick:function(){return A(e)}},s&&u.default.createElement(n.Td,c({},g,{cursor:"pointer",onClick:function(){return N(e.id)}}),u.default.createElement(n.Flex,{alignItems:"center",justifyContent:"center",position:"relative"},u.default.createElement("input",{type:"checkbox",checked:D.includes(e.id),readOnly:!0}))),e.getVisibleCells().map((function(t){return u.default.createElement(n.Td,c({},g,{key:t.id}),t.column.columnDef.render?t.column.columnDef.render(r[e.id]):a.flexRender(t.column.columnDef.cell,t.getContext()))})))})))),b&&u.default.createElement(C,{table:R}))},y=function(e){var t=e.caption;return u.default.createElement(n.TableCaption,{placement:"top",bg:"blackAlpha.900",color:"white",fontSize:"md",p:3,mt:0},t)},C=function(e){var t=e.table;return u.default.createElement(n.Flex,{mt:4,textAlign:"center",alignItems:"center",justifyContent:"space-evenly"},u.default.createElement(m,{table:t}),u.default.createElement(b,{table:t}))};function v(e){var t,l,a,r,o=e.column;return"number"==typeof(null===(t=e.table.getPreFilteredRowModel().flatRows[0])||void 0===t?void 0:t.getValue(o.id))?u.default.createElement(n.Flex,{w:"100%"},u.default.createElement(n.Input,{size:"sm",mt:2,focusBorderColor:"#0044BB",textAlign:"center",bg:"white",textColor:"black",p:0,value:null!==(l=null===(a=o.getFilterValue())||void 0===a?void 0:a[0])&&void 0!==l?l:"",onChange:function(e){o.setFilterValue((function(t){return[e.target.value,null==t?void 0:t[1]]})),o.setFilterValue((function(t){return[null==t?void 0:t[0],e.target.value]}))},placeholder:"最小值"})):u.default.createElement(n.Input,{size:"sm",mt:2,focusBorderColor:"#0044BB",textAlign:"center",bg:"white",textColor:"black",p:0,value:null!==(r=o.getFilterValue())&&void 0!==r?r:"",onChange:function(e){return o.setFilterValue(e.target.value)},placeholder:"輸入以查詢"})}p.propTypes={columns:i.default.arrayOf(i.default.object).isRequired,data:i.default.arrayOf(i.default.object).isRequired,tableStyle:i.default.object,thStyle:i.default.object,tdStyle:i.default.object,renderRowSubComponents:i.default.arrayOf(i.default.func),enableMultiSelect:i.default.bool,onSelectedRowsChange:i.default.func,enablePagination:i.default.bool,enableCaption:i.default.bool,enableFilter:i.default.bool,enableRowDoubleClick:i.default.bool,rowDoubleClickHandler:i.default.func,caption:i.default.string},p.defaultProps={tableStyle:{textAlign:"center",size:"sm",border:"1px",borderColor:"blackAlpha.900"},thStyle:{border:"1px",textAlign:"center",borderColor:"blackAlpha.900",bg:"teal.400",color:"white",fontSize:"md"},tdStyle:{border:"1px",borderColor:"blackAlpha.900",textAlign:"center"},renderRowSubComponents:[],enableMultiSelect:!1,enablePagination:!1,enableCaption:!1,enableFilter:!1,enableRowDoubleClick:!1,rowDoubleClickHandler:function(e){alert("Double Clicked Row ".concat(e.id))},caption:""},exports.DataTable=p;
